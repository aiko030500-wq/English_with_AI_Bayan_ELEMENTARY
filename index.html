<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ENGLISH WITH AI BAYAN ‚Äì Intermediate</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      /* Burgundy palette */
      --blue-main:#7b1f3a;
      --blue-soft:#a13a50;
      --gold:#ffd54f;
      --bg:#f9f4f6;
      --topicColor:#7b1f3a;
    }

    *{
      box-sizing:border-box;
      margin:0;
      padding:0;
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
    }

    body{
      background:var(--bg);
      color:#3b1d23;
    }

    /* HEADER WITH GIRL LOGO */
    header{
      background:linear-gradient(90deg,var(--blue-main),var(--blue-soft));
      color:#fff;
      padding:10px 24px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      box-shadow:0 2px 6px rgba(0,0,0,.2);
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .logo-img{
      width:50px;
      height:50px;
      border-radius:50%;
      object-fit:cover;
      border:3px solid var(--gold);
      background:white;
    }

    .brand-text h1{
      font-size:18px;
      letter-spacing:.04em;
    }

    .brand-text span{
      font-size:12px;
      opacity:.9;
    }

    .top-info{
      font-size:13px;
      text-align:right;
    }
    .top-info strong{color:var(--gold);}

    main{
      padding:16px;
      max-width:1300px;
      margin:0 auto;
    }

    .card{
      background:#fff;
      border-radius:14px;
      box-shadow:0 4px 14px rgba(0,0,0,.08);
      padding:20px;
    }

    .hidden{display:none !important;}

    .section-title{
      font-size:18px;
      margin-bottom:10px;
      font-weight:600;
    }
    .muted{
      color:#705e68;
      font-size:12px;
    }

    .field-label{
      font-size:14px;
      margin-bottom:4px;
    }

    .text-input{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid #c9b7c0;
      margin-bottom:14px;
      font-size:14px;
    }
    .text-input:focus{
      outline:none;
      border-color:var(--blue-soft);
      box-shadow:0 0 0 2px rgba(161,58,80,.25);
    }

    .btn{
      border:none;
      border-radius:10px;
      padding:10px 18px;
      font-size:14px;
      font-weight:600;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
    }
    .btn-primary{
      background:var(--blue-soft);
      color:#fff;
    }
    .btn-primary:hover{background:#8c3246;}
    .btn-ghost{
      background:#f4e5ea;
      color:var(--blue-main);
    }
    .btn-ghost:hover{background:#ead2db;}

    .login-note{
      font-size:12px;
      color:#705e68;
      margin-top:10px;
      line-height:1.4;
    }

    .error{
      margin-top:10px;
      color:#b00020;
      font-size:13px;
    }

    /* SCREENS */
    #loginScreen{
      max-width:520px;
      margin:40px auto;
    }

    #mainMenuScreen{
      display:grid;
      grid-template-columns:2fr 1.2fr;
      gap:16px;
    }
    @media(max-width:960px){
      #mainMenuScreen{
        grid-template-columns:1fr;
      }
    }

    .tag{
      display:inline-block;
      padding:2px 6px;
      border-radius:999px;
      background:#fbe9eb;
      font-size:11px;
      color:var(--blue-main);
    }

    .top-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      gap:8px;
      margin-bottom:12px;
    }

    .stars-badge{
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:4px 8px;
      border-radius:999px;
      background:#fff9e5;
      border:1px solid #ffe082;
      font-size:12px;
    }
    .star-icon{color:#ffb300;}

    .topics-grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:10px;
      margin-top:8px;
    }
    @media(max-width:700px){
      .topics-grid{grid-template-columns:1fr;}
    }

    .topic-card{
      border-radius:12px;
      border:1px solid #e1c3cf;
      padding:10px 12px;
      background:#fdf7fa;
      cursor:pointer;
      transition:.15s;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .topic-card:hover{
      background:#f7dde9;
      transform:translateY(-1px);
    }
    .topic-card-title{
      font-size:14px;
      font-weight:600;
    }
    .topic-card-sub{
      font-size:11px;
      color:#705e68;
    }

    /* AI PANEL (demo) */
    #aiPanel{
      background:#fff;
      border-radius:14px;
      padding:14px;
      box-shadow:0 2px 10px rgba(0,0,0,.06);
      display:flex;
      flex-direction:column;
      gap:8px;
      min-height:260px;
    }
    #aiPanel h3{
      font-size:15px;
      margin-bottom:4px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:6px;
    }
    #aiLimit{
      font-size:11px;
    }
    .chat-note{
      font-size:11px;
      color:#705e68;
    }
    .chat-box{
      flex:1;
      border-radius:10px;
      border:1px solid #e1c3cf;
      padding:8px;
      background:#fdf7fa;
      font-size:13px;
      overflow-y:auto;
    }
    .chat-msg{
      margin-bottom:6px;
      line-height:1.4;
    }
    .chat-msg strong{color:var(--blue-main);}
    #aiQuestion{
      width:100%;
      min-height:60px;
      resize:vertical;
      border-radius:10px;
      border:1px solid #c9b7c0;
      padding:8px;
      font-size:13px;
      margin-top:4px;
    }
    #aiQuestion:focus{
      outline:none;
      border-color:var(--blue-soft);
      box-shadow:0 0 0 2px rgba(161,58,80,.2);
    }
    .chat-actions{
      display:flex;
      justify-content:flex-end;
      margin-top:4px;
    }

    /* TOPIC SCREEN */
    #topicScreen{
      max-width:1000px;
      margin:0 auto;
    }
    .topic-header{
      border-radius:16px 16px 0 0;
      padding:14px 16px;
      background:linear-gradient(90deg,var(--topicColor),#b34765);
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .topic-header-main{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .topic-header-title{
      font-size:18px;
      font-weight:600;
    }
    .topic-header-tag{
      font-size:11px;
      opacity:.9;
    }
    .topic-header-buttons{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }
    .btn-topic{
      border:none;
      border-radius:999px;
      padding:6px 12px;
      font-size:12px;
      cursor:pointer;
      font-weight:600;
    }
    .btn-topic.back{
      background:#ffffff;
      color:var(--topicColor);
    }
    .btn-topic.menu{
      background:rgba(255,255,255,.15);
      color:#fff;
      border:1px solid rgba(255,255,255,.5);
    }

    .topic-body{
      background:#fff;
      border-radius:0 0 16px 16px;
      box-shadow:0 4px 14px rgba(0,0,0,.08);
      padding:16px;
    }

    .grammar-box{
      background:#fdf3f6;
      border-left:4px solid var(--topicColor);
      padding:10px 12px;
      border-radius:10px;
      margin-bottom:12px;
      font-size:14px;
      line-height:1.5;
    }
    .grammar-box strong{color:var(--blue-main);}
    .formula{
      font-family:"Consolas","Courier New",monospace;
      background:#f7dde9;
      padding:3px 6px;
      border-radius:6px;
      margin-right:4px;
      display:inline-block;
      margin-top:4px;
    }
    .examples{
      margin-top:8px;
      font-size:13px;
    }
    .examples li{
      margin-left:18px;
      margin-bottom:2px;
    }
    .grammar-ru{
      margin-top:10px;
      font-size:13px;
      color:#3b1d23;
    }

    .exercises{
      margin-top:12px;
    }
    .exercise-block{
      border-radius:12px;
      background:#fdf7fa;
      padding:10px 12px;
      margin-bottom:10px;
      border:1px solid #e1c3cf;
    }
    .exercise-title{
      font-size:14px;
      font-weight:600;
      margin-bottom:6px;
    }
    .question-row{
      font-size:13px;
      margin-bottom:6px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:6px;
    }
    .question-text{
      flex:1 1 160px;
    }
    .options{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      align-items:center;
    }
    .options label{
      background:#ffffff;
      border-radius:999px;
      border:1px solid #e1c3cf;
      padding:2px 8px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:3px;
    }
    .options input[type="radio"]{
      accent-color:var(--topicColor);
    }
    .mark{
      width:18px;
      text-align:center;
      font-size:16px;
      font-weight:700;
    }
    .mark.correct{color:#2e7d32;}
    .mark.wrong{color:#c62828;}
    .exercise-footer{
      margin-top:6px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .exercise-footer small{
      font-size:11px;
      color:#705e68;
    }

    /* TEACHER */
    #teacherScreen{
      margin-top:20px;
    }
    .top-buttons{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .table-wrapper{
      overflow-x:auto;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
      margin-top:10px;
    }
    th,td{
      border:1px solid #e1c3cf;
      padding:6px 8px;
      text-align:left;
      white-space:nowrap;
    }
    th{
      background:#f7dde9;
      font-weight:600;
    }

    /* PRINT: only topic */
    @media print{
      header, #loginScreen, #mainMenuScreen, #teacherScreen{
        display:none !important;
      }
      body{
        background:#fff;
      }
      #topicScreen{
        display:block !important;
        margin:0;
        padding:0;
      }
      .topic-body{
        box-shadow:none;
        border-radius:0;
      }
    }
  </style>
</head>
<body>
<header>
  <div class="brand">
    <img src="logo.png" alt="AI Bayan" class="logo-img">
    <div class="brand-text">
      <h1>ENGLISH WITH AI BAYAN</h1>
      <span>Intermediate ¬∑ 20 grammar topics</span>
    </div>
  </div>
  <div class="top-info" id="topInfo">Not logged in</div>
</header>

<main>
  <!-- LOGIN -->
  <section id="loginScreen" class="card">
    <h2 class="section-title">Login</h2>
    <p class="muted" style="margin-bottom:10px">
      Enter your <strong>Name</strong> and <strong>Code</strong>. Ask your teacher for the code.
    </p>

    <label class="field-label" for="loginName">Name</label>
    <input id="loginName" class="text-input" type="text" placeholder="Your name" />

    <label class="field-label" for="loginCode">Code</label>
    <input id="loginCode" class="text-input" type="password" placeholder="Student or teacher code" />

    <div style="display:flex;gap:8px;margin-top:4px">
      <button class="btn btn-primary" onclick="handleLogin()">Login</button>
      <button class="btn btn-ghost" onclick="backToLogin()">Reset</button>
    </div>

    <div id="loginError" class="error hidden"></div>

    <!-- No PIN ranges or teacher code hints on screen -->
    <p class="login-note">
      Your teacher will give you your personal student code and the teacher code.
    </p>
  </section>

  <!-- MAIN MENU (STUDENT) -->
  <section id="mainMenuScreen" class="hidden">
    <section class="card">
      <div class="top-row">
        <div>
          <h2 class="section-title" style="margin-bottom:4px;">Intermediate grammar topics</h2>
          <div id="menuInfo" class="muted"></div>
        </div>
        <div>
          <span class="stars-badge">
            <span class="star-icon">‚≠ê</span>
            Stars: <span id="menuStars">0</span>
          </span>
        </div>
      </div>

      <div class="topics-grid" id="menuTopics"></div>
    </section>

    <aside id="aiPanel">
      <div>
        <h3>
          AI Bayan
          <span id="aiLimit"></span>
        </h3>
        <p class="chat-note">
          Demo mode. AI chat will be added later.
        </p>
      </div>

      <div id="chatBox" class="chat-box"></div>

      <div>
        <textarea id="aiQuestion"
                  placeholder="AI chat will be available soon."
                  disabled></textarea>
        <div class="chat-actions">
          <button class="btn btn-primary" id="askBtn" disabled>Ask (soon)</button>
        </div>
        <p class="chat-note">
          Your questions will be visible for the teacher in the future version.
        </p>
      </div>
    </aside>
  </section>

  <!-- TOPIC SCREEN -->
  <section id="topicScreen" class="hidden">
    <div class="topic-header">
      <div class="topic-header-main">
        <div class="topic-header-title" id="topicHeaderTitle">Topic</div>
        <div class="topic-header-tag" id="topicHeaderTag"></div>
      </div>
      <div class="topic-header-buttons">
        <button class="btn-topic back" onclick="backToMenu()">‚Üê Back</button>
        <button class="btn-topic menu" onclick="backToMenu()">üè† Main menu</button>
        <button class="btn-topic menu" onclick="printCurrentTopic()">üñ® Print</button>
      </div>
    </div>
    <div class="topic-body">
      <div id="topicRuleContainer"></div>
      <div id="topicExercisesContainer"></div>
      <div id="topicStatus" class="muted" style="margin-top:8px;"></div>
    </div>
  </section>

  <!-- TEACHER -->
  <section id="teacherScreen" class="hidden card">
    <div class="top-buttons">
      <button class="btn btn-ghost" onclick="backToLogin()">‚Üê Back to login</button>
      <span class="tag">Teacher mode</span>
    </div>
    <h2 class="section-title">Teacher dashboard</h2>
    <p class="muted">
      Shows data saved in this browser: stars and last login (per code).
    </p>

    <div class="table-wrapper">
      <table id="teacherTable">
        <thead>
          <tr>
            <th>Class</th>
            <th>Code</th>
            <th>Name</th>
            <th>Stars</th>
            <th>Last login</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</main>

<script>
/* ---------- CLASS RANGES (PIN) ---------- */

const classRanges = [
  { cls: "3E",  from: 101,  to: 115 },
  { cls: "4G",  from: 201,  to: 215 },
  { cls: "5G",  from: 301,  to: 315 },
  { cls: "5Zh", from: 401,  to: 415 },
  { cls: "6G",  from: 501,  to: 515 },
  { cls: "7B",  from: 601,  to: 615 },
  { cls: "7V",  from: 701,  to: 715 },
  { cls: "8E",  from: 801,  to: 815 },
  { cls: "9Zh", from: 901,  to: 915 },
  { cls: "10A", from: 1001, to: 1015 }
];

function getClassByCode(num){
  for (const r of classRanges){
    if (num >= r.from && num <= r.to){
      return r.cls;
    }
  }
  return null;
}

/* ---------- TOPIC COLORS ---------- */

const topicColors = {
  1:"#7b1f3a",
  2:"#8e2442",
  3:"#a13a50",
  4:"#b34765",
  5:"#5d1a2e",
  6:"#7b1f3a",
  7:"#8e2442",
  8:"#a13a50",
  9:"#b34765",
  10:"#5d1a2e",
  11:"#7b1f3a",
  12:"#8e2442",
  13:"#a13a50",
  14:"#b34765",
  15:"#5d1a2e",
  16:"#7b1f3a",
  17:"#8e2442",
  18:"#a13a50",
  19:"#b34765",
  20:"#5d1a2e"
};

/* ---------- TOPICS (20 INTERMEDIATE, 7 exercises per topic) ---------- */

const topics = [
  {
    id:1,
    title:"Present Perfect vs Past Simple",
    level:"Intermediate",
    explanation:"Present Perfect is used for life experience and results that are connected with now (ever, never, already, yet) and we do not say the exact finished time. Past Simple is used for finished actions in the past with a clear time (yesterday, last week, in 2020).",
    ruleRu:"Present Perfect ‚Äì –æ–ø—ã—Ç –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –Ω–∞—Å—Ç–æ—è—â–∏–º, –±–µ–∑ —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (ever, never, already, yet). Past Simple ‚Äì –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –ø—Ä–æ—à–ª–æ–º —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (yesterday, last year, in 2020).",
    formulas:["have/has + V3","V2 / V-ed"],
    examples:[
      "I have seen this film three times.",
      "I saw this film last year."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct option.",
        questions:[
          {
            text:"We ____ this film three times.",
            options:["have seen","saw","see"],
            correct:0
          },
          {
            text:"I ____ to London in 2019.",
            options:["have been","went","have gone"],
            correct:1
          },
          {
            text:"She ____ already finished her homework.",
            options:["has","have","did"],
            correct:0
          },
          {
            text:"They ____ the new museum yesterday.",
            options:["have visited","visited","have been visiting"],
            correct:1
          },
          {
            text:"I have never ____ sushi.",
            options:["eat","eaten","ate"],
            correct:1
          },
          {
            text:"He ____ his keys last week.",
            options:["has lost","lost","have lost"],
            correct:1
          },
          {
            text:"She ____ just called me.",
            options:["has","have","did"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Present Perfect or Past Simple",
        questions:[
          {
            text:"They ____ (finish) their project already.",
            options:["finished","have finished","has finished"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Present Perfect or Past Simple",
        questions:[
          {
            text:"We ____ (see) him yesterday.",
            options:["have seen","saw","seen"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Present Perfect or Past Simple",
        questions:[
          {
            text:"I ____ (not visit) my grandparents last month.",
            options:["haven't visited","didn't visit","don't visit"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Present Perfect or Past Simple",
        questions:[
          {
            text:"She ____ (live) here since 2018.",
            options:["lived","has lived","was living"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Present Perfect or Past Simple",
        questions:[
          {
            text:"He ____ (already / do) his homework.",
            options:["already did","has already done","did already"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Present Perfect or Past Simple",
        questions:[
          {
            text:"I ____ (see) this film last week.",
            options:["have seen","saw","seen"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:2,
    title:"Present Perfect Continuous",
    level:"Intermediate",
    explanation:"We use Present Perfect Continuous for actions that started in the past and are still happening now or have a visible result now. We often use it with for, since, recently, lately.",
    ruleRu:"Present Perfect Continuous ‚Äì –¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞—á–∞–ª–æ—Å—å –≤ –ø—Ä–æ—à–ª–æ–º –∏ –¥–ª–∏—Ç—Å—è –¥–æ —Å–∏—Ö –ø–æ—Ä –∏–ª–∏ –¥–∞–ª–æ –≤–∏–¥–∏–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ–π—á–∞—Å. –ß–∞—Å—Ç–æ —Å for, since, recently, lately.",
    formulas:["have/has been + V-ing"],
    examples:[
      "I have been studying English for three years.",
      "She has been working here since 2020."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct sentence.",
        questions:[
          {
            text:"She ____ English for five years.",
            options:["has studied","has been studying","was studying"],
            correct:1
          },
          {
            text:"They ____ in the garden since morning.",
            options:["have worked","have been working","work"],
            correct:1
          },
          {
            text:"I ____ this book all day and I am tired.",
            options:["have read","have been reading","read"],
            correct:1
          },
          {
            text:"He ____ games since two o clock.",
            options:["has been playing","played","has played"],
            correct:0
          },
          {
            text:"We ____ for the bus for twenty minutes.",
            options:["have waited","have been waiting","wait"],
            correct:1
          },
          {
            text:"It is wet. It ____ all night.",
            options:["has rained","has been raining","rained"],
            correct:1
          },
          {
            text:"She is tired because she ____.",
            options:["has been running","ran","has run"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Present Perfect or Continuous",
        questions:[
          {
            text:"I ____ (wait) for you for half an hour.",
            options:["have waited","have been waiting","am waiting"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Present Perfect Continuous",
        questions:[
          {
            text:"She is dirty. She ____ (work) in the garden.",
            options:["has worked","has been working","worked"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Present Perfect Continuous",
        questions:[
          {
            text:"They ____ (talk) on the phone since 8 o clock.",
            options:["have talked","have been talking","are talking"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Present Perfect vs Continuous",
        questions:[
          {
            text:"We ____ (live) here for ten years.",
            options:["have lived","have been living","lived"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. For / Since",
        questions:[
          {
            text:"He has been playing the guitar ____ he was ten.",
            options:["for","since","during"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. For / Since",
        questions:[
          {
            text:"I have been learning English ____ three years.",
            options:["for","since","from"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:3,
    title:"Past Continuous vs Past Simple",
    level:"Intermediate",
    explanation:"Past Continuous describes a long or background action in the past. Past Simple describes short, finished actions that happened one after another or interrupted the background action.",
    ruleRu:"Past Continuous ‚Äì –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –∏–ª–∏ —Ñ–æ–Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤ –ø—Ä–æ—à–ª–æ–º. Past Simple ‚Äì –∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ, —á–∞—Å—Ç–æ ¬´–≤—Ä–µ–∑–∞–µ—Ç—Å—è¬ª –≤ —Ñ–æ–Ω (when/while).",
    formulas:["was/were + V-ing","V2 / V-ed"],
    examples:[
      "I was watching TV when he called.",
      "It started to rain while we were walking home."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the best option.",
        questions:[
          {
            text:"I ____ dinner when my friend called.",
            options:["was cooking","cooked","have cooked"],
            correct:0
          },
          {
            text:"They ____ football when it started to rain.",
            options:["played","were playing","have played"],
            correct:1
          },
          {
            text:"She ____ when she fell off the bike.",
            options:["was running","ran","has run"],
            correct:0
          },
          {
            text:"We ____ to music while we were cleaning.",
            options:["listened","were listening","have listened"],
            correct:1
          },
          {
            text:"He ____ a book when I came in.",
            options:["read","was reading","has read"],
            correct:1
          },
          {
            text:"The lights went out while I ____ a shower.",
            options:["took","was taking","have taken"],
            correct:1
          },
          {
            text:"They ____ TV after they finished homework.",
            options:["were watching","watched","have watched"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Past Simple or Continuous",
        questions:[
          {
            text:"I ____ (walk) home when it started to rain.",
            options:["walked","was walking","have walked"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. When / While",
        questions:[
          {
            text:"____ I was doing homework, my brother was playing games.",
            options:["When","While","Before"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. When / While",
        questions:[
          {
            text:"I hurt my leg ____ I was playing football.",
            options:["when","while","because"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Background vs short action",
        questions:[
          {
            text:"They ____ (have) dinner when the phone rang.",
            options:["had","were having","have had"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Past Simple or Continuous",
        questions:[
          {
            text:"He ____ (listen) to music when I entered the room.",
            options:["listened","was listening","has listened"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Past Simple or Continuous",
        questions:[
          {
            text:"We ____ (not watch) TV when mum came home.",
            options:["didn't watch","weren't watching","haven't watched"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:4,
    title:"Future forms: will / going to / Present Continuous",
    level:"Intermediate",
    explanation:"Will is used for instant decisions, promises and predictions. Be going to is used for plans and intentions and for predictions with evidence. Present Continuous is used for fixed future arrangements (timetable, meeting, calendar).",
    ruleRu:"Will ‚Äì —Ä–µ—à–µ–Ω–∏–µ —Å–µ–π—á–∞—Å, –æ–±–µ—â–∞–Ω–∏–µ, –ø—Ä–æ–≥–Ω–æ–∑. Be going to ‚Äì –ø–ª–∞–Ω –∏–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ, ¬´—è —Å–æ–±–∏—Ä–∞—é—Å—å¬ª. Present Continuous ‚Äì –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –Ω–∞ –±—É–¥—É—â–µ–µ (–≤—Å—Ç—Ä–µ—á–∏, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ).",
    formulas:["will + V","am/is/are going to + V","am/is/are + V-ing (future)"],
    examples:[
      "I think it will rain tomorrow.",
      "We are going to visit our grandma.",
      "They are meeting at 7 pm."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct future form.",
        questions:[
          {
            text:"I am cold. I ____ close the window.",
            options:["am going to","will","am"],
            correct:1
          },
          {
            text:"They ____ visit their cousins next weekend. It is their plan.",
            options:["will","are going to","are visiting"],
            correct:1
          },
          {
            text:"We ____ the teacher at 3 pm tomorrow. It is in the diary.",
            options:["will meet","are meeting","are going to meet"],
            correct:1
          },
          {
            text:"Look at those clouds. It ____ rain.",
            options:["will","is going to","is raining"],
            correct:1
          },
          {
            text:"I think our team ____ win the match.",
            options:["is going to","will","is winning"],
            correct:1
          },
          {
            text:"She ____ start a new course next month. She has decided.",
            options:["is going to","will","is starting"],
            correct:0
          },
          {
            text:"We ____ have lunch with our grandparents on Sunday. It is arranged.",
            options:["are having","will have","are going to have"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Will vs going to",
        questions:[
          {
            text:"It is very late. I think I ____ go to bed.",
            options:["am going to","will","am"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Will vs going to",
        questions:[
          {
            text:"He has bought tickets. He ____ travel to Astana.",
            options:["will","is going to","is travelling"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Present Continuous for arrangements",
        questions:[
          {
            text:"We ____ (meet) our friends at six tomorrow.",
            options:["meet","are meeting","will meet"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Choose the future form",
        questions:[
          {
            text:"They ____ (visit) their grandma on Saturday. It is already planned.",
            options:["are going to visit","will visit","visit"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Predictions",
        questions:[
          {
            text:"I am sure you ____ pass the exam.",
            options:["are going to","will","are passing"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Evidence prediction",
        questions:[
          {
            text:"Look at that boy. He is carrying many books. He ____ drop them.",
            options:["is going to","will","is dropping"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:5,
    title:"Used to / be used to / get used to",
    level:"Intermediate",
    explanation:"Used to + V is for past habits or states that are not true now. Be used to + V-ing/noun is for something that is normal for you now. Get used to + V-ing/noun is the process of becoming accustomed.",
    ruleRu:"Used to + V ‚Äì —Ä–∞–Ω—å—à–µ –¥–µ–ª–∞–ª/–±—ã–ª–æ, –Ω–æ —Å–µ–π—á–∞—Å –Ω–µ—Ç. Be used to + V-ing/—Å—É—â. ‚Äì –ø—Ä–∏–≤—ã–∫, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. Get used to + V-ing/—Å—É—â. ‚Äì –ø—Ä–∏–≤—ã–∫–∞–µ—Ç (–ø—Ä–æ—Ü–µ—Å—Å).",
    formulas:["used to + V","be used to + V-ing / noun","get used to + V-ing / noun"],
    examples:[
      "I used to live in a village.",
      "She is used to getting up early.",
      "They are getting used to online lessons."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct form.",
        questions:[
          {
            text:"I ____ play the piano, but I do not now.",
            options:["am used to","used to","get used to"],
            correct:1
          },
          {
            text:"She ____ waking up at six. It is easy for her.",
            options:["is used to","used to","gets used to"],
            correct:0
          },
          {
            text:"They are new here and they are ____ the city.",
            options:["used to","getting used to","get used to"],
            correct:1
          },
          {
            text:"We ____ live near the sea, but now we live in a city.",
            options:["used to","are used to","get used to"],
            correct:1
          },
          {
            text:"He will ____ driving on the left soon.",
            options:["be used to","get used to","used to"],
            correct:1
          },
          {
            text:"I am not ____ spicy food yet.",
            options:["used to","use to","getting used to"],
            correct:0
          },
          {
            text:"She ____ work at night, so she is tired.",
            options:["is not used to","did not use to","does not used to"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Used to",
        questions:[
          {
            text:"He ____ (live) in Almaty, but now he lives in Aktau.",
            options:["used to live","is used to live","gets used to live"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Be used to",
        questions:[
          {
            text:"She ____ (be) used to cold weather.",
            options:["is","is being","was"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 4. Get used to",
        questions:[
          {
            text:"I am slowly ____ (get) used to online lessons.",
            options:["getting","get","got"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Choose the structure",
        questions:[
          {
            text:"We ____ (be) used to long school days.",
            options:["are","used to","get"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Choose the structure",
        questions:[
          {
            text:"They ____ (use) to go to this cafe every weekend.",
            options:["used","used to","are used"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Be / get used to",
        questions:[
          {
            text:"He is ____ (get) used to his new job.",
            options:["get","getting","got"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:6,
    title:"Modal verbs of deduction (must / might / can‚Äôt)",
    level:"Intermediate",
    explanation:"We use must when we are almost sure something is true now, might/may/could when it is possible, and can‚Äôt when we are sure it is impossible.",
    ruleRu:"–ú–æ–¥–∞–ª—å–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã –¥–ª—è –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π –æ –Ω–∞—Å—Ç–æ—è—â–µ–º: must ‚Äì –Ω–∞–≤–µ—Ä–Ω—è–∫–∞; might/may/could ‚Äì –≤–æ–∑–º–æ–∂–Ω–æ; can‚Äôt ‚Äì –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å.",
    formulas:["must + V","might / may / could + V","can‚Äôt + V"],
    examples:[
      "He must be at home ‚Äì the lights are on.",
      "She might be at the library.",
      "He can‚Äôt be 10, he looks 20."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the best modal verb.",
        questions:[
          {
            text:"The lights are off. They ____ be at home.",
            options:["must","might","cannot"],
            correct:2
          },
          {
            text:"She looks very happy. She ____ have passed the exam.",
            options:["must","might","cannot"],
            correct:0
          },
          {
            text:"He is late, but the bus is often slow. He ____ be on the bus.",
            options:["must","might","cannot"],
            correct:1
          },
          {
            text:"This task is very easy. It ____ be a problem for you.",
            options:["must","might","cannot"],
            correct:2
          },
          {
            text:"I am not sure, but it ____ rain later.",
            options:["must","might","cannot"],
            correct:1
          },
          {
            text:"She knows all the answers. She ____ be very clever.",
            options:["must","might","cannot"],
            correct:0
          },
          {
            text:"He is only five. He ____ read this difficult book.",
            options:["must","might","cannot"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 2. Must / can‚Äôt",
        questions:[
          {
            text:"He is wearing a coat. It ____ be cold outside.",
            options:["can‚Äôt","must","might"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Might / may / could",
        questions:[
          {
            text:"She ____ be at home, but I am not sure.",
            options:["must","might","can‚Äôt"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Must / can‚Äôt",
        questions:[
          {
            text:"He is smiling. He ____ be sad.",
            options:["must","might","can‚Äôt"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 5. Deduction",
        questions:[
          {
            text:"Your bag is not here. You ____ have left it at school.",
            options:["must","might","can‚Äôt"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Deduction",
        questions:[
          {
            text:"The door is open. Somebody ____ be in the room.",
            options:["can‚Äôt","must","might"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Deduction",
        questions:[
          {
            text:"She speaks English perfectly. She ____ have studied a lot.",
            options:["must","might","can‚Äôt"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:7,
    title:"Second Conditional",
    level:"Intermediate",
    explanation:"Second Conditional is used for unreal or imaginary situations in the present or future: dreams, advice and hypothetical situations.",
    ruleRu:"Second Conditional ‚Äì –Ω–µ—Ä–µ–∞–ª—å–Ω—ã–µ, –≤–æ–æ–±—Ä–∞–∂–∞–µ–º—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –ø—Ä–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ/–±—É–¥—É—â–µ–µ: –º–µ—á—Ç—ã, —Å–æ–≤–µ—Ç—ã ¬´–Ω–∞ —Ç–≤–æ—ë–º –º–µ—Å—Ç–µ¬ª.",
    formulas:["If + Past Simple, would + V"],
    examples:[
      "If I had a lot of money, I would travel around the world.",
      "If she studied harder, she would get better marks."
    ],
    exercises:[
      {
        title:"Exercise 1. Complete the conditional.",
        questions:[
          {
            text:"If I ____ rich, I would buy a big house.",
            options:["am","were","was"],
            correct:1
          },
          {
            text:"If she studied harder, she ____ better marks.",
            options:["will get","would get","got"],
            correct:1
          },
          {
            text:"If we lived by the sea, we ____ swim every day.",
            options:["will","would","can"],
            correct:1
          },
          {
            text:"If he ____ more time, he would start a new hobby.",
            options:["had","has","have"],
            correct:0
          },
          {
            text:"If they knew the answer, they ____ tell you.",
            options:["will","would","can"],
            correct:1
          },
          {
            text:"I would help you if I ____ free tomorrow.",
            options:["am","was","were"],
            correct:2
          },
          {
            text:"If I were you, I ____ speak to the teacher.",
            options:["will","would","can"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Second Conditional",
        questions:[
          {
            text:"If I ____ (have) wings, I would fly everywhere.",
            options:["had","have","would have"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Second Conditional",
        questions:[
          {
            text:"If we lived in the countryside, we ____ (have) more fresh air.",
            options:["will have","would have","had"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Second Conditional",
        questions:[
          {
            text:"If she were taller, she ____ (play) basketball.",
            options:["will play","would play","played"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. If I were you",
        questions:[
          {
            text:"If I were you, I ____ (talk) to my parents.",
            options:["would talk","will talk","talked"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Imaginary present",
        questions:[
          {
            text:"If he ____ (know) the answer, he would tell us.",
            options:["knows","knew","would know"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Imaginary future",
        questions:[
          {
            text:"If we ____ (win) the lottery, we would buy a new house.",
            options:["win","won","would win"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:8,
    title:"Mixed Conditionals",
    level:"Intermediate",
    explanation:"Mixed conditionals connect different times: unreal past action with a present result, or unreal present situation with a past result.",
    ruleRu:"–°–º–µ—à–∞–Ω–Ω—ã–µ —É—Å–ª–æ–≤–Ω—ã–µ —Å–≤—è–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞: –µ—Å–ª–∏ –±—ã —á—Ç–æ-—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –≤ –ø—Ä–æ—à–ª–æ–º, —Å–µ–π—á–∞—Å –±—ã–ª–æ –±—ã –∏–Ω–∞—á–µ; –∏–ª–∏ –µ—Å–ª–∏ –±—ã —Å–µ–π—á–∞—Å –±—ã–ª–æ –ø–æ-–¥—Ä—É–≥–æ–º—É, –≤ –ø—Ä–æ—à–ª–æ–º –±—ã–ª–æ –±—ã –∏–Ω–∞—á–µ.",
    formulas:[
      "If + Past Perfect, would + V (now)",
      "If + Past Simple, would have + V3 (past result)"
    ],
    examples:[
      "If I had studied harder, I would be at university now.",
      "If I were taller, I would have become a basketball player."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct mixed conditional.",
        questions:[
          {
            text:"If I had gone to bed earlier, I ____ tired now.",
            options:["would not be","would not have been","am not"],
            correct:0
          },
          {
            text:"If she were more careful, she ____ that mistake yesterday.",
            options:["would not make","would not have made","did not make"],
            correct:1
          },
          {
            text:"If they had left earlier, they ____ stuck in traffic now.",
            options:["would not be","would not have been","are not"],
            correct:0
          },
          {
            text:"If he were taller, he ____ the match last year.",
            options:["would win","would have won","won"],
            correct:1
          },
          {
            text:"If I liked maths, I ____ an engineer now.",
            options:["would become","would have become","was"],
            correct:0
          },
          {
            text:"If we had saved more money, we ____ on holiday now.",
            options:["would be","would have been","are"],
            correct:0
          },
          {
            text:"If she knew French, she ____ that job last month.",
            options:["would get","would have got","got"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Past ‚Üí present result",
        questions:[
          {
            text:"If I had studied harder, I ____ more confident now.",
            options:["would be","would have been","am"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Present ‚Üí past result",
        questions:[
          {
            text:"If he were more polite, he ____ invited to more parties.",
            options:["would be","would have been","was"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Mixed type",
        questions:[
          {
            text:"If she had woken up earlier, she ____ late now.",
            options:["wouldn't be","wouldn't have been","isn't"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Mixed type",
        questions:[
          {
            text:"If I were braver, I ____ that exam last year.",
            options:["would pass","would have passed","passed"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Mixed type",
        questions:[
          {
            text:"If we had known the truth, we ____ so angry now.",
            options:["wouldn't be","wouldn't have been","aren't"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 7. Mixed type",
        questions:[
          {
            text:"If they were richer, they ____ a bigger party last summer.",
            options:["would have had","would have","had"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:9,
    title:"Passive Voice (Intermediate)",
    level:"Intermediate",
    explanation:"In the Passive Voice we focus on the action, not on the doer. We use it when the doer is unknown, unimportant or obvious.",
    ruleRu:"–°—Ç—Ä–∞–¥–∞—Ç–µ–ª—å–Ω—ã–π –∑–∞–ª–æ–≥ (Passive) ‚Äì –≤–∞–∂–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ, —á–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: ¬´–¥–æ–º –ø–æ—Å—Ç—Ä–æ–∏–ª–∏¬ª, –∞ –Ω–µ ¬´–∫—Ç–æ-—Ç–æ –ø–æ—Å—Ç—Ä–æ–∏–ª –¥–æ–º¬ª. –ò—Å–ø–æ–ª—å–∑—É–µ–º, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω –∏–ª–∏ –Ω–µ –≤–∞–∂–µ–Ω.",
    formulas:[
      "Present: am/is/are + V3",
      "Past: was/were + V3",
      "Future: will be + V3"
    ],
    examples:[
      "The homework is checked every day.",
      "This film was made in 2019.",
      "The project will be finished next week."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct passive form.",
        questions:[
          {
            text:"This song ____ every day on the radio.",
            options:["plays","is played","was played"],
            correct:1
          },
          {
            text:"The letter ____ yesterday.",
            options:["is sent","was sent","will be sent"],
            correct:1
          },
          {
            text:"The new road ____ next year.",
            options:["is built","was built","will be built"],
            correct:2
          },
          {
            text:"These houses ____ in 1990.",
            options:["are built","were built","will be built"],
            correct:1
          },
          {
            text:"English ____ in many countries.",
            options:["is spoken","was spoken","speaks"],
            correct:0
          },
          {
            text:"The homework ____ at the moment.",
            options:["is checked","was checked","will be checked"],
            correct:0
          },
          {
            text:"The windows ____ tomorrow.",
            options:["are cleaned","were cleaned","will be cleaned"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 2. Present Passive",
        questions:[
          {
            text:"Milk ____ (sell) in this shop.",
            options:["is sold","was sold","will be sold"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Past Passive",
        questions:[
          {
            text:"The test ____ (check) yesterday.",
            options:["is checked","was checked","will be checked"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Future Passive",
        questions:[
          {
            text:"The results ____ (announce) next week.",
            options:["are announced","were announced","will be announced"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 5. Choose tense",
        questions:[
          {
            text:"The room ____ (clean) every day.",
            options:["is cleaned","was cleaned","will be cleaned"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Choose tense",
        questions:[
          {
            text:"Our school ____ (build) in 2000.",
            options:["is built","was built","will be built"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Choose tense",
        questions:[
          {
            text:"A new shopping centre ____ (open) next month.",
            options:["is opened","was opened","will be opened"],
            correct:2
          }
        ]
      }
    ]
  },
  {
    id:10,
    title:"Reported Speech (statements & questions)",
    level:"Intermediate",
    explanation:"In reported speech we say what someone said without quotation marks and usually move the tense one step back into the past.",
    ruleRu:"–ö–æ—Å–≤–µ–Ω–Ω–∞—è —Ä–µ—á—å ‚Äì –ø–µ—Ä–µ–¥–∞—ë–º —á—É–∂–∏–µ —Å–ª–æ–≤–∞ –±–µ–∑ –∫–∞–≤—ã—á–µ–∫, –æ–±—ã—á–Ω–æ —Å–¥–≤–∏–≥–∞—è –≤—Ä–µ–º—è ¬´–Ω–∞ —à–∞–≥ –Ω–∞–∑–∞–¥¬ª: am ‚Üí was, do ‚Üí did, will ‚Üí would –∏ —Ç.–¥.",
    formulas:[
      "say / tell + (that) + clause",
      "Present ‚Üí Past, Past ‚Üí Past Perfect, will ‚Üí would"
    ],
    examples:[
      "He said that he was tired.",
      "She asked if I liked English."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct reported sentence.",
        questions:[
          {
            text:"He said, I am busy.",
            options:[
              "He said that he is busy.",
              "He said that he was busy.",
              "He said that I was busy."
            ],
            correct:1
          },
          {
            text:"She said, I do not like coffee.",
            options:[
              "She said that she did not like coffee.",
              "She said that she does not like coffee.",
              "She said that she liked coffee."
            ],
            correct:0
          },
          {
            text:"They said, We will come tomorrow.",
            options:[
              "They said that they would come the next day.",
              "They said that they will come the next day.",
              "They said that we would come tomorrow."
            ],
            correct:0
          },
          {
            text:"He asked, Do you like sports",
            options:[
              "He asked if I like sports.",
              "He asked if I liked sports.",
              "He asked did I like sports."
            ],
            correct:1
          },
          {
            text:"She asked, Where do you live",
            options:[
              "She asked where I live.",
              "She asked where did I live.",
              "She asked where I lived."
            ],
            correct:2
          },
          {
            text:"My friend said, I saw this film.",
            options:[
              "My friend said that he had seen that film.",
              "My friend said that he saw that film.",
              "My friend said that he has seen that film."
            ],
            correct:0
          },
          {
            text:"He said, I can help you.",
            options:[
              "He said that he could help me.",
              "He said that he can help me.",
              "He said that I could help him."
            ],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Backshift of tenses",
        questions:[
          {
            text:"She said, I am tired. ‚Üí She said that she ____ tired.",
            options:["is","was","were"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Backshift of tenses",
        questions:[
          {
            text:"He said, I will call you. ‚Üí He said that he ____ call me.",
            options:["would","will","can"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 4. Reported questions",
        questions:[
          {
            text:"He asked, Where are you from ‚Üí He asked where I ____ from.",
            options:["am","was","were"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Reported yes/no questions",
        questions:[
          {
            text:"She asked, Do you like English ‚Üí She asked if I ____ English.",
            options:["liked","like","was liking"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Pronouns",
        questions:[
          {
            text:"My brother said, I lost my keys ‚Üí My brother said that he lost ____ keys.",
            options:["my","his","their"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Time words",
        questions:[
          {
            text:"She said, I will see you tomorrow ‚Üí She said that she would see me ____.",
            options:["tomorrow","the next day","yesterday"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:11,
    title:"Relative Clauses (who / which / where)",
    level:"Intermediate",
    explanation:"We use who for people, which for things and animals, and where for places to add extra information about a noun.",
    ruleRu:"–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è: who ‚Äì –ª—é–¥–∏, which ‚Äì –ø—Ä–µ–¥–º–µ—Ç—ã –∏ –∂–∏–≤–æ—Ç–Ω—ã–µ, where ‚Äì –º–µ—Å—Ç–∞. –û–Ω–∏ –ø–æ–º–æ–≥–∞—é—Ç —Å–æ–µ–¥–∏–Ω—è—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏ —É—Ç–æ—á–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ.",
    formulas:["noun + who/which/where + clause"],
    examples:[
      "The man who lives next door is a doctor.",
      "This is the place where we met.",
      "That‚Äôs the dog which barks a lot."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct relative pronoun.",
        questions:[
          {
            text:"The girl ____ is wearing a red dress is my sister.",
            options:["which","who","where"],
            correct:1
          },
          {
            text:"This is the shop ____ we buy bread.",
            options:["who","which","where"],
            correct:2
          },
          {
            text:"The book ____ is on the table is mine.",
            options:["who","which","where"],
            correct:1
          },
          {
            text:"The man ____ helped me is very kind.",
            options:["who","which","where"],
            correct:0
          },
          {
            text:"That is the park ____ we play football.",
            options:["who","which","where"],
            correct:2
          },
          {
            text:"The dog ____ lives next door is very friendly.",
            options:["who","which","where"],
            correct:1
          },
          {
            text:"I visited the town ____ my grandparents live.",
            options:["who","which","where"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 2. Who / which",
        questions:[
          {
            text:"The woman ____ lives next door is a teacher.",
            options:["which","who","where"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Where",
        questions:[
          {
            text:"This is the place ____ we first met.",
            options:["who","which","where"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 4. Which",
        questions:[
          {
            text:"The car ____ is parked outside is mine.",
            options:["who","which","where"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Who",
        questions:[
          {
            text:"The boy ____ won the competition is my friend.",
            options:["who","which","where"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 6. Mixed",
        questions:[
          {
            text:"That is the restaurant ____ we had dinner.",
            options:["who","which","where"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"This is the dog ____ barks every night.",
            options:["who","which","where"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:12,
    title:"Gerunds & Infinitives",
    level:"Intermediate",
    explanation:"Some verbs are followed by a gerund (V-ing), some by an infinitive (to + V), and some by object + infinitive.",
    ruleRu:"–ü–æ—Å–ª–µ —Ä–∞–∑–Ω—ã—Ö –≥–ª–∞–≥–æ–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã: Gerund (V-ing) ‚Äì enjoy, avoid, finish; Infinitive (to V) ‚Äì want, decide, hope; –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è V + object + to V ‚Äì want someone to do.",
    formulas:["V + V-ing","V + to V","V + object + to V"],
    examples:[
      "I enjoy reading books.",
      "She decided to move.",
      "They want us to help."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct form.",
        questions:[
          {
            text:"I enjoy ____ music.",
            options:["to listen","listening","listen"],
            correct:1
          },
          {
            text:"She decided ____ abroad.",
            options:["to study","studying","study"],
            correct:0
          },
          {
            text:"They want us ____ early.",
            options:["to come","coming","come"],
            correct:0
          },
          {
            text:"He finished ____ the letter.",
            options:["to write","writing","write"],
            correct:1
          },
          {
            text:"I hope ____ you soon.",
            options:["to see","seeing","see"],
            correct:0
          },
          {
            text:"My parents allowed me ____ TV.",
            options:["to watch","watching","watch"],
            correct:0
          },
          {
            text:"She suggested ____ to the park.",
            options:["to go","going","go"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Gerund",
        questions:[
          {
            text:"He enjoys ____ (play) football.",
            options:["to play","playing","play"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Infinitive",
        questions:[
          {
            text:"I want ____ (learn) English.",
            options:["to learn","learning","learn"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 4. Object + infinitive",
        questions:[
          {
            text:"The teacher told us ____ (be) quiet.",
            options:["be","to be","being"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Mixed",
        questions:[
          {
            text:"They decided ____ (go) home.",
            options:["going","to go","go"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Mixed",
        questions:[
          {
            text:"She avoided ____ (talk) about the problem.",
            options:["to talk","talking","talk"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"My parents want me ____ (help) them.",
            options:["help","helping","to help"],
            correct:2
          }
        ]
      }
    ]
  },
  {
    id:13,
    title:"Articles (a/an, the, zero)",
    level:"Intermediate",
    explanation:"We use a/an for a thing we mention for the first time or one of many, the for specific or known things, and no article (zero) for plural and uncountable nouns in general, languages, sports and most places.",
    ruleRu:"A/An ‚Äì ¬´–∫–∞–∫–æ–π-—Ç–æ, –æ–¥–∏–Ω¬ª (–≥–æ–≤–æ—Ä–∏–º –≤–ø–µ—Ä–≤—ã–µ). The ‚Äì ¬´—Ç–æ—Ç —Å–∞–º—ã–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π¬ª. –ù–æ–ª—å –∞—Ä—Ç–∏–∫–ª—è ‚Äì –≤–æ–æ–±—â–µ, –≤ —Ü–µ–ª–æ–º (music, water), —è–∑—ã–∫–∏, –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞ –∏ —Ç.–ø.",
    formulas:[
      "a/an + singular countable noun",
      "the + specific noun",
      "√ò + general / plural / uncountable"
    ],
    examples:[
      "He is an engineer.",
      "I like the film you recommended.",
      "They play football."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct article.",
        questions:[
          {
            text:"My father is ____ engineer.",
            options:["a","an","the"],
            correct:1
          },
          {
            text:"I like ____ music.",
            options:["a","the","√ò"],
            correct:2
          },
          {
            text:"We went to ____ cinema yesterday.",
            options:["a","the","√ò"],
            correct:1
          },
          {
            text:"She bought ____ new dress.",
            options:["a","the","√ò"],
            correct:0
          },
          {
            text:"____ Nile is a long river.",
            options:["A","The","√ò"],
            correct:1
          },
          {
            text:"He plays ____ football every weekend.",
            options:["a","the","√ò"],
            correct:2
          },
          {
            text:"____ English is not easy.",
            options:["The","An","√ò"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. A / an",
        questions:[
          {
            text:"She has ____ orange bag.",
            options:["a","an","the"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. The",
        questions:[
          {
            text:"Please open ____ window. It is very hot.",
            options:["a","an","the"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 4. Zero article",
        questions:[
          {
            text:"I like ____ chocolate.",
            options:["a","the","√ò"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 5. Zero article",
        questions:[
          {
            text:"They play ____ tennis every Sunday.",
            options:["a","the","√ò"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 6. Mixed",
        questions:[
          {
            text:"We visited ____ Louvre when we were in Paris.",
            options:["a","the","√ò"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"____ sun is shining today.",
            options:["A","The","√ò"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:14,
    title:"Phrasal Verbs",
    level:"Intermediate",
    explanation:"A phrasal verb is a verb + a small word (particle) like up, on, off, after, and often the whole expression has a new meaning.",
    ruleRu:"–§—Ä–∞–∑–æ–≤—ã–π –≥–ª–∞–≥–æ–ª ‚Äì –≥–ª–∞–≥–æ–ª + –º–∞–ª–µ–Ω—å–∫–æ–µ —Å–ª–æ–≤–æ (up, on, off, after‚Ä¶), –≤–º–µ—Å—Ç–µ —á–∞—Å—Ç–æ –¥–∞—é—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: break up ‚Äì —Ä–∞—Å—Å—Ç–∞—Ç—å—Å—è, look after ‚Äì –ø—Ä–∏—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å.",
    formulas:["verb + particle ‚Üí new meaning"],
    examples:[
      "They broke up last year.",
      "She looks after her little brother.",
      "Please turn off the lights."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct phrasal verb.",
        questions:[
          {
            text:"Please ____ the lights before you leave.",
            options:["turn up","turn off","turn on"],
            correct:1
          },
          {
            text:"She ____ after her little sister every day.",
            options:["looks after","looks for","looks up"],
            correct:0
          },
          {
            text:"They ____ up last month.",
            options:["broke","broke out","broke up"],
            correct:2
          },
          {
            text:"I will ____ you up at seven o clock.",
            options:["take","pick","pick up"],
            correct:2
          },
          {
            text:"He ____ up smoking last year.",
            options:["gave","gave up","gave in"],
            correct:1
          },
          {
            text:"We need to ____ this word in the dictionary.",
            options:["look at","look for","look up"],
            correct:2
          },
          {
            text:"Do not ____ up. Keep trying.",
            options:["give","give up","break up"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Turn on / turn off",
        questions:[
          {
            text:"It is dark here. Please ____ the light.",
            options:["turn off","turn on","turn up"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Look after / look for",
        questions:[
          {
            text:"Can you ____ my bag while I am away",
            options:["look for","look after","look up"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Look for / look up",
        questions:[
          {
            text:"I need to ____ my keys. I cannot find them.",
            options:["look for","look after","look up"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Give up",
        questions:[
          {
            text:"He wants to ____ smoking.",
            options:["give","give up","break up"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Break up",
        questions:[
          {
            text:"They decided to ____ after many arguments.",
            options:["break up","turn off","look after"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 7. Mixed phrasal verbs",
        questions:[
          {
            text:"Can you ____ this word in the dictionary",
            options:["look for","look after","look up"],
            correct:2
          }
        ]
      }
    ]
  },
  {
    id:15,
    title:"Linking Words",
    level:"Intermediate",
    explanation:"Linking words connect ideas: although and however show contrast; because shows reason; therefore shows result; in order to shows purpose.",
    ruleRu:"–°–≤—è–∑—É—é—â–∏–µ —Å–ª–æ–≤–∞: although ‚Äì —Ö–æ—Ç—è, however ‚Äì –æ–¥–Ω–∞–∫–æ, because ‚Äì –ø–æ—Ç–æ–º—É —á—Ç–æ, therefore ‚Äì –ø–æ—ç—Ç–æ–º—É, in order to ‚Äì —á—Ç–æ–±—ã (—Ü–µ–ª—å).",
    formulas:[
      "although + clause",
      "clause. However, clause.",
      "because + clause",
      "clause; therefore, clause.",
      "in order to + V"
    ],
    examples:[
      "Although it was cold, we went out.",
      "He was tired; however, he finished the work.",
      "She stayed home because she was ill."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the best linking word.",
        questions:[
          {
            text:"____ it was raining, we went for a walk.",
            options:["Because","Although","Therefore"],
            correct:1
          },
          {
            text:"I stayed at home ____ I felt sick.",
            options:["because","although","however"],
            correct:0
          },
          {
            text:"He was tired; ____ he finished the project.",
            options:["because","however","although"],
            correct:1
          },
          {
            text:"She studies hard ____ get good marks.",
            options:["in order to","because","although"],
            correct:0
          },
          {
            text:"It was very late; ____ we went to bed.",
            options:["however","because","therefore"],
            correct:2
          },
          {
            text:"____ he is very busy, he always helps me.",
            options:["Because","Although","Therefore"],
            correct:1
          },
          {
            text:"She failed the test ____ she did not study.",
            options:["because","although","however"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Because / although",
        questions:[
          {
            text:"____ it was cold, we went swimming.",
            options:["Although","Because","Therefore"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Because",
        questions:[
          {
            text:"We stayed at home ____ it was snowing.",
            options:["although","because","however"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Therefore",
        questions:[
          {
            text:"He did not study; ____ he failed the exam.",
            options:["however","therefore","although"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. However",
        questions:[
          {
            text:"It was very cold. ____ , we went for a walk.",
            options:["Therefore","Because","However"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 6. In order to",
        questions:[
          {
            text:"She turned on the computer ____ check her email.",
            options:["because","in order to","although"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Mixed linking words",
        questions:[
          {
            text:"____ he was tired, he finished his homework.",
            options:["Although","Because","Therefore"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:16,
    title:"Countable & Uncountable Nouns",
    level:"Intermediate",
    explanation:"Countable nouns can be counted (one, two, three apples). Uncountable nouns cannot be counted easily (water, rice, sugar). We use different quantifiers with them.",
    ruleRu:"–ò—Å—á–∏—Å–ª—è–µ–º—ã–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å (apple, book). –ù–µ–∏—Å—á–∏—Å–ª—è–µ–º—ã–µ –Ω–µ–ª—å–∑—è –ø–æ—Å—á–∏—Ç–∞—Ç—å –ø–æ—à—Ç—É—á–Ω–æ (water, rice, sugar). –° –Ω–∏–º–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–∞–∑–Ω—ã–µ —Å–ª–æ–≤–∞ much/many, little/few –∏ —Ç.–¥.",
    formulas:[
      "many / few / a few + countable",
      "much / little / a little + uncountable",
      "some / any + –æ–±–∞ —Ç–∏–ø–∞"
    ],
    examples:[
      "There are many books.",
      "There is a little water.",
      "Do you have any friends here?"
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct word.",
        questions:[
          {
            text:"There are ____ apples on the table.",
            options:["much","many","little"],
            correct:1
          },
          {
            text:"We do not have ____ milk.",
            options:["many","much","few"],
            correct:1
          },
          {
            text:"There are only ____ students in the classroom.",
            options:["a little","a few","much"],
            correct:1
          },
          {
            text:"I drink ____ water every day.",
            options:["many","much","few"],
            correct:1
          },
          {
            text:"We need ____ sugar for this cake.",
            options:["a few","a little","many"],
            correct:1
          },
          {
            text:"There are ____ chairs but not enough.",
            options:["few","a little","much"],
            correct:0
          },
          {
            text:"Do you have ____ questions",
            options:["some","any","much"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Countable or uncountable",
        questions:[
          {
            text:"Sugar is ____ noun.",
            options:["a countable","an uncountable","a plural"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Much / many",
        questions:[
          {
            text:"How ____ brothers do you have",
            options:["much","many","little"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Little / few",
        questions:[
          {
            text:"We have ____ time. Hurry up!",
            options:["few","little","many"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Some / any",
        questions:[
          {
            text:"Do you have ____ money",
            options:["some","any","much"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Some / any",
        questions:[
          {
            text:"There are ____ apples in the fridge.",
            options:["some","any","much"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"We have ____ chairs but too ____ space.",
            options:["many / little","much / many","few / many"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:17,
    title:"Complex Object (V + object + to V)",
    level:"Intermediate",
    explanation:"Complex Object is used after verbs like want, ask, tell, expect, allow when one person wants another person to do something.",
    ruleRu:"–°–ª–æ–∂–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: –≥–ª–∞–≥–æ–ª + –æ–±—ä–µ–∫—Ç + to V. –ü—Ä–∏–º–µ—Ä—ã –≥–ª–∞–≥–æ–ª–æ–≤: want, ask, tell, expect, allow. I want you to help ‚Äì ¬´–Ø —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç—ã –ø–æ–º–æ–≥¬ª.",
    formulas:["S + V + object + to V"],
    examples:[
      "I want you to listen carefully.",
      "They asked him to come early.",
      "She told me to wait."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct complex object.",
        questions:[
          {
            text:"I want you ____ this exercise.",
            options:["do","to do","doing"],
            correct:1
          },
          {
            text:"She asked him ____ earlier.",
            options:["to come","come","coming"],
            correct:0
          },
          {
            text:"My parents expect me ____ hard.",
            options:["study","to study","studying"],
            correct:1
          },
          {
            text:"The teacher told us ____ quietly.",
            options:["to work","work","working"],
            correct:0
          },
          {
            text:"They would like their son ____ a doctor.",
            options:["be","being","to be"],
            correct:2
          },
          {
            text:"I did not want them ____ about the problem.",
            options:["to know","know","knowing"],
            correct:0
          },
          {
            text:"Our coach allowed us ____ home early.",
            options:["go","to go","going"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Want + object + to V",
        questions:[
          {
            text:"I want my friend ____ (help) me.",
            options:["help","to help","helping"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 3. Ask + object + to V",
        questions:[
          {
            text:"They asked us ____ (come) on time.",
            options:["come","to come","coming"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Tell + object + to V",
        questions:[
          {
            text:"Mum told me ____ (wash) the dishes.",
            options:["to wash","wash","washing"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Would like + object + to V",
        questions:[
          {
            text:"I would like you ____ (visit) me.",
            options:["visit","to visit","visiting"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Allow + object + to V",
        questions:[
          {
            text:"My parents allowed me ____ (stay) up late.",
            options:["stay","to stay","staying"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Expect + object + to V",
        questions:[
          {
            text:"The teacher expects us ____ (do) our homework.",
            options:["do","to do","doing"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:18,
    title:"Causative (have/get something done)",
    level:"Intermediate",
    explanation:"We use the causative when someone does something for us as a service: I had my hair cut (= someone cut my hair for me).",
    ruleRu:"–ö–∞—É–∑–∞—Ç–∏–≤: –º—ã –∑–∞–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ª—É–≥—É, –∏ –∫—Ç–æ-—Ç–æ –¥–µ–ª–∞–µ—Ç —á—Ç–æ-—Ç–æ –¥–ª—è –Ω–∞—Å. I had my hair cut ‚Äì –º–Ω–µ –ø–æ—Å—Ç—Ä–∏–≥–ª–∏ –≤–æ–ª–æ—Å—ã.",
    formulas:["have / get + object + V3"],
    examples:[
      "I had my phone repaired.",
      "She got her hair cut yesterday."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct causative form.",
        questions:[
          {
            text:"I ____ my car washed yesterday.",
            options:["had","had got","had my car"],
            correct:0
          },
          {
            text:"She ____ her hair cut every month.",
            options:["gets","gets her hair","gets her hair cut"],
            correct:2
          },
          {
            text:"We will ____ our house painted next year.",
            options:["have","have get","have our house"],
            correct:0
          },
          {
            text:"He ____ his phone repaired last week.",
            options:["got","got his phone repaired","got repaired"],
            correct:1
          },
          {
            text:"They ____ their photo taken at the studio.",
            options:["had","had their photo taken","had taken"],
            correct:1
          },
          {
            text:"I am going to ____ my bike fixed.",
            options:["have","get","have get"],
            correct:1
          },
          {
            text:"We ____ the windows cleaned every spring.",
            options:["have","have got","get cleaned"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 2. Have something done",
        questions:[
          {
            text:"I ____ my hair cut tomorrow.",
            options:["am having","have got","get"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Get something done",
        questions:[
          {
            text:"She ____ her phone repaired last week.",
            options:["got","had","was"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 4. Choose have/get",
        questions:[
          {
            text:"We will ____ our roof repaired next month.",
            options:["have","get","got"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 5. Service",
        questions:[
          {
            text:"They ____ their car washed every Sunday.",
            options:["have","get","got"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Meaning",
        questions:[
          {
            text:"I had my house painted means:",
            options:["I painted my house.","Someone painted my house for me.","I will paint my house."],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"We ____ our photos taken for the passport yesterday.",
            options:["had","got","have"],
            correct:0
          }
        ]
      }
    ]
  },
  {
    id:19,
    title:"Cleft Sentences (It is/was ‚Ä¶ that ‚Ä¶)",
    level:"Intermediate",
    explanation:"Cleft sentences use It is/was to emphasise a person, thing, place or time: It was John who helped me.",
    ruleRu:"Cleft-–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç –≤–∞–∂–Ω—É—é —á–∞—Å—Ç—å: It was John who helped me ‚Äì –∏–º–µ–Ω–Ω–æ –î–∂–æ–Ω –ø–æ–º–æ–≥ –º–Ω–µ.",
    formulas:["It is/was + noun/pronoun + who/that + clause"],
    examples:[
      "It was my mum who cooked dinner.",
      "It is this book that I like most."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct cleft sentence.",
        questions:[
          {
            text:"____ my brother who fixed the computer.",
            options:[
              "It is",
              "It was",
              "There was"
            ],
            correct:1
          },
          {
            text:"It was yesterday ____ we met.",
            options:["who","that","when"],
            correct:1
          },
          {
            text:"____ my mother who taught me to read.",
            options:[
              "It is",
              "It was",
              "There is"
            ],
            correct:1
          },
          {
            text:"It is English ____ I like most.",
            options:["who","that","when"],
            correct:1
          },
          {
            text:"It was in London ____ they first met.",
            options:["who","that","when"],
            correct:1
          },
          {
            text:"____ my best friend who helped me.",
            options:[
              "It was",
              "There was",
              "It is that"
            ],
            correct:0
          },
          {
            text:"It is my room ____ needs cleaning.",
            options:["who","that","where"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 2. Emphasis on person",
        questions:[
          {
            text:"____ my dad who drives me to school.",
            options:["It is","There is","It was"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 3. Emphasis on time",
        questions:[
          {
            text:"It was last year ____ we moved to Aktau.",
            options:["who","that","when"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 4. Emphasis on place",
        questions:[
          {
            text:"It was in this park ____ we met.",
            options:["who","that","where"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 5. Emphasis on thing",
        questions:[
          {
            text:"It is this song ____ I like most.",
            options:["who","that","where"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Present vs past",
        questions:[
          {
            text:"____ my mum who cooked dinner yesterday.",
            options:["It is","It was","There is"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"It is my phone ____ is on the table.",
            options:["who","that","where"],
            correct:1
          }
        ]
      }
    ]
  },
  {
    id:20,
    title:"Quantifiers: too / enough / so / such",
    level:"Intermediate",
    explanation:"We use too to mean more than is good, enough to mean sufficient, so before an adjective to mean very, and such + (a) + adjective + noun to mean very with a noun.",
    ruleRu:"Too ‚Äì —Å–ª–∏—à–∫–æ–º; enough ‚Äì –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ; so ‚Äì —Ç–∞–∫, –æ—á–µ–Ω—å; such ‚Äì —Ç–∞–∫–æ–π/—Ç–∞–∫–∞—è + —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ.",
    formulas:[
      "too + adjective",
      "adjective + enough",
      "so + adjective",
      "such + (a) + adjective + noun"
    ],
    examples:[
      "It is too cold.",
      "She is tall enough to play basketball.",
      "It is such a nice day."
    ],
    exercises:[
      {
        title:"Exercise 1. Choose the correct quantifier.",
        questions:[
          {
            text:"It is ____ cold to go outside.",
            options:["so","such","too"],
            correct:2
          },
          {
            text:"She is not old ____ to drive a car.",
            options:["too","enough","so"],
            correct:1
          },
          {
            text:"It is ____ a beautiful garden.",
            options:["so","such","too"],
            correct:1
          },
          {
            text:"He is ____ tired that he cannot walk.",
            options:["too","such","so"],
            correct:0
          },
          {
            text:"It was ____ an interesting film.",
            options:["so","such","too"],
            correct:1
          },
          {
            text:"The box is not light ____ to carry.",
            options:["too","enough","so"],
            correct:1
          },
          {
            text:"She is ____ kind.",
            options:["too","such","so"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 2. Too",
        questions:[
          {
            text:"The tea is ____ hot to drink.",
            options:["so","such","too"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 3. Enough",
        questions:[
          {
            text:"We do not have ____ chairs for everyone.",
            options:["too","so","enough"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 4. So",
        questions:[
          {
            text:"He is ____ funny.",
            options:["too","such","so"],
            correct:2
          }
        ]
      },
      {
        title:"Exercise 5. Such",
        questions:[
          {
            text:"It is ____ a nice day today.",
            options:["so","such","too"],
            correct:1
          }
        ]
      },
      {
        title:"Exercise 6. Mixed",
        questions:[
          {
            text:"The homework is ____ difficult that many students cannot do it.",
            options:["too","such","so"],
            correct:0
          }
        ]
      },
      {
        title:"Exercise 7. Mixed",
        questions:[
          {
            text:"She is ____ a good singer.",
            options:["so","such","too"],
            correct:1
          }
        ]
      }
    ]
  }
];

/* ---------- STATE & STORAGE ---------- */

let currentUser = null; // {name, code, classLabel, stars, lastLogin}
let currentTopicId = null;

function todayStr(){
  return new Date().toISOString().slice(0,10);
}
function studentKey(code){
  return "bayan_student_"+code;
}

function loadStudent(code,name,classLabel){
  const key = studentKey(code);
  let data = null;
  try{
    data = JSON.parse(localStorage.getItem(key));
  }catch(e){
    data=null;
  }
  if(!data){
    data = {
      name:name||"",
      code,
      classLabel,
      stars:0,
      lastLogin:null
    };
  }else{
    if(name) data.name = name;
    data.classLabel = classLabel;
  }
  data.lastLogin = todayStr();
  localStorage.setItem(key,JSON.stringify(data));
  return data;
}
function saveCurrent(){
  if(!currentUser) return;
  const key = studentKey(currentUser.code);
  localStorage.setItem(key,JSON.stringify(currentUser));
}

/* ---------- SCREEN SWITCHING ---------- */

function showOnly(id){
  document.getElementById("loginScreen").classList.add("hidden");
  document.getElementById("mainMenuScreen").classList.add("hidden");
  document.getElementById("topicScreen").classList.add("hidden");
  document.getElementById("teacherScreen").classList.add("hidden");
  document.getElementById(id).classList.remove("hidden");
}
function setTopInfo(html){
  document.getElementById("topInfo").innerHTML = html;
}

/* ---------- LOGIN ---------- */

function handleLogin(){
  const name = document.getElementById("loginName").value.trim();
  const codeStr = document.getElementById("loginCode").value.trim();
  const errorEl = document.getElementById("loginError");
  errorEl.classList.add("hidden");
  errorEl.textContent = "";

  if(!codeStr){
    errorEl.textContent = "Enter your code.";
    errorEl.classList.remove("hidden");
    return;
  }

  // teacher code (hidden from students on the screen)
  if(codeStr==="3234"){
    setTopInfo(`Logged in as <strong>TEACHER</strong> ¬∑ code 3234`);
    renderTeacherTable();
    showOnly("teacherScreen");
    return;
  }

  const num = Number(codeStr);
  if(!Number.isInteger(num)){
    errorEl.textContent = "Code must be a number.";
    errorEl.classList.remove("hidden");
    return;
  }
  const classLabel = getClassByCode(num);
  if(!classLabel){
    errorEl.textContent = "Unknown student code. Ask your teacher.";
    errorEl.classList.remove("hidden");
    return;
  }
  if(!name){
    errorEl.textContent = "Enter your name.";
    errorEl.classList.remove("hidden");
    return;
  }

  currentUser = loadStudent(num,name,classLabel);
  saveCurrent();
  setTopInfo(
    `Class <strong>${currentUser.classLabel}</strong> ¬∑ Student: <strong>${currentUser.name}</strong> (code ${currentUser.code}) ¬∑ Stars: <strong id="topStars">${currentUser.stars}</strong>`
  );
  buildMainMenu();
  updateTopStars();
  showOnly("mainMenuScreen");
}

function backToLogin(){
  currentUser = null;
  setTopInfo("Not logged in");
  document.getElementById("loginCode").value = "";
  document.getElementById("loginName").value = "";
  showOnly("loginScreen");
}

/* ---------- MAIN MENU UI ---------- */

function buildMainMenu(){
  if(!currentUser) return;
  document.getElementById("menuInfo").innerHTML =
    `Class <strong>${currentUser.classLabel}</strong>, student <strong>${currentUser.name}</strong> (code ${currentUser.code})`;
  document.getElementById("menuStars").textContent = currentUser.stars ?? 0;

  const grid = document.getElementById("menuTopics");
  grid.innerHTML = "";
  topics.forEach(t=>{
    const div = document.createElement("div");
    div.className = "topic-card";
    const color = topicColors[t.id] || "#7b1f3a";
    div.style.borderColor = color+"55";
    div.style.background = "#fdf7fa";
    div.innerHTML = `
      <div class="topic-card-title">${t.id}. ${t.title}</div>
      <div class="topic-card-sub">${t.level}</div>
    `;
    div.addEventListener("click",()=>openTopic(t.id));
    grid.appendChild(div);
  });

  // demo message in AI panel
  const chat = document.getElementById("chatBox");
  chat.innerHTML = "";
  const msg = document.createElement("div");
  msg.className = "chat-msg";
  msg.textContent = "AI Bayan chat will be available later. Now use topics and explanations.";
  chat.appendChild(msg);
  document.getElementById("aiLimit").textContent = "¬∑ demo mode";
}

/* ---------- TOPIC SCREEN ---------- */

function openTopic(id){
  currentTopicId = id;
  const t = topics.find(x=>x.id===id);
  if(!t) return;

  const color = topicColors[id] || "#7b1f3a";
  document.documentElement.style.setProperty("--topicColor",color);

  document.getElementById("topicHeaderTitle").textContent = `${id}. ${t.title}`;
  document.getElementById("topicHeaderTag").innerHTML =
    `<span class="tag">${t.level}</span>`;

  const rc = document.getElementById("topicRuleContainer");
  rc.innerHTML = "";
  const gbox = document.createElement("div");
  gbox.className = "grammar-box";
  gbox.innerHTML = `
    <strong>Rule (EN):</strong> ${t.explanation || ""}
    ${
      t.formulas && t.formulas.length
        ? "<div style='margin-top:6px;'>"+
          t.formulas.map(f=>`<span class="formula">${f}</span>`).join(" ")+
          "</div>"
        : ""
    }
    ${
      t.ruleRu
        ? `<div class="grammar-ru">
             <strong>–ü—Ä–∞–≤–∏–ª–æ (RU):</strong><br>
             ${t.ruleRu}
           </div>`
        : ""
    }
  `;
  rc.appendChild(gbox);

  if(t.examples && t.examples.length){
    const ul = document.createElement("ul");
    ul.className = "examples";
    t.examples.forEach(e=>{
      const li = document.createElement("li");
      li.textContent = e;
      ul.appendChild(li);
    });
    rc.appendChild(ul);
  }

  const ec = document.getElementById("topicExercisesContainer");
  ec.innerHTML = "";
  if(!t.exercises || t.exercises.length===0){
    const p = document.createElement("p");
    p.className = "muted";
    p.style.marginTop = "10px";
    p.textContent = "Exercises for this topic will be added later.";
    ec.appendChild(p);
  }else{
    const wrapper = document.createElement("div");
    wrapper.className = "exercises";
    t.exercises.forEach((ex,exIndex)=>{
      const block = document.createElement("div");
      block.className = "exercise-block";
      const title = document.createElement("div");
      title.className = "exercise-title";
      title.innerHTML = ex.title;
      block.appendChild(title);

      ex.questions.forEach((q,qIndex)=>{
        const row = document.createElement("div");
        row.className = "question-row";
        const qText = document.createElement("div");
        qText.className = "question-text";
        qText.textContent = `${qIndex+1}) ${q.text}`;
        row.appendChild(qText);

        const opts = document.createElement("div");
        opts.className = "options";
        if(q.options && q.options.length){
          q.options.forEach((opt,optIndex)=>{
            const label = document.createElement("label");
            const radio = document.createElement("input");
            radio.type = "radio";
            const gname = `t${id}_e${exIndex}_q${qIndex}`;
            radio.name = gname;
            radio.value = optIndex;
            label.appendChild(radio);
            label.appendChild(document.createTextNode(" "+opt));
            opts.appendChild(label);
          });
        }
        row.appendChild(opts);

        const mark = document.createElement("span");
        mark.className = "mark";
        mark.id = `mark_t${id}_e${exIndex}_q${qIndex}`;
        row.appendChild(mark);

        block.appendChild(row);
      });

      const footer = document.createElement("div");
      footer.className = "exercise-footer";
      const small = document.createElement("small");
      small.textContent = "Each correct answer gives you 1 star.";
      const btn = document.createElement("button");
      btn.className = "btn btn-primary";
      btn.textContent = "Check";
      btn.addEventListener("click",()=>checkExercise(id,exIndex));
      footer.appendChild(small);
      footer.appendChild(btn);
      block.appendChild(footer);

      wrapper.appendChild(block);
    });
    ec.appendChild(wrapper);
  }

  document.getElementById("topicStatus").textContent = "";
  showOnly("topicScreen");
}

function backToMenu(){
  if(!currentUser){
    backToLogin();
    return;
  }
  buildMainMenu();
  showOnly("mainMenuScreen");
}

function printCurrentTopic(){
  if(!currentTopicId) return;
  window.print();
}

function checkExercise(topicId,exIndex){
  if(!currentUser) return;
  const t = topics.find(x=>x.id===topicId);
  if(!t) return;
  const ex = t.exercises[exIndex];
  if(!ex) return;

  let gained = 0;
  ex.questions.forEach((q,qIndex)=>{
    const gname = `t${topicId}_e${exIndex}_q${qIndex}`;
    const selected = document.querySelector(`input[name="${gname}"]:checked`);
    const markEl = document.getElementById(`mark_t${topicId}_e${exIndex}_q${qIndex}`);
    if(!markEl) return;
    markEl.textContent = "";
    markEl.classList.remove("correct","wrong");

    if(!selected){
      markEl.textContent = "‚Ä¢";
      return;
    }
    const chosen = Number(selected.value);
    if(chosen===q.correct){
      markEl.textContent="‚úì";
      markEl.classList.add("correct");
      gained++;
    }else{
      markEl.textContent="‚úó";
      markEl.classList.add("wrong");
    }
  });

  const status = document.getElementById("topicStatus");
  if(gained>0){
    currentUser.stars += gained;
    saveCurrent();
    updateTopStars();
    if(status){
      status.textContent = `Well done! You gained ${gained} star(s).`;
    }
  }else{
    if(status){
      status.textContent = "No correct answers yet. Try again!";
    }
  }
}

/* ---------- TEACHER TABLE ---------- */

function renderTeacherTable(){
  const tbody = document.querySelector("#teacherTable tbody");
  tbody.innerHTML = "";
  const allStudents = [];
  classRanges.forEach(r=>{
    for(let code=r.from; code<=r.to; code++){
      const key = studentKey(code);
      let data = null;
      try{
        data = JSON.parse(localStorage.getItem(key));
      }catch(e){ data=null; }
      if(data) allStudents.push(data);
    }
  });
  if(allStudents.length===0){
    const tr = document.createElement("tr");
    const td = document.createElement("td");
    td.colSpan = 5;
    td.textContent =
      "No student data in this browser yet. Ask students to log in and work with tasks.";
    tr.appendChild(td);
    tbody.appendChild(tr);
    return;
  }
  allStudents.sort((a,b)=>a.code-b.code);
  allStudents.forEach(s=>{
    const tr = document.createElement("tr");
    const cls = document.createElement("td");
    cls.textContent = s.classLabel || getClassByCode(s.code) || "";
    const codeTd = document.createElement("td");
    codeTd.textContent = s.code;
    const nameTd = document.createElement("td");
    nameTd.textContent = s.name || "";
    const starsTd = document.createElement("td");
    starsTd.textContent = s.stars ?? 0;
    const loginTd = document.createElement("td");
    loginTd.textContent = s.lastLogin || "";
    tr.appendChild(cls);
    tr.appendChild(codeTd);
    tr.appendChild(nameTd);
    tr.appendChild(starsTd);
    tr.appendChild(loginTd);
    tbody.appendChild(tr);
  });
}

/* ---------- INIT & STARS ---------- */

function updateTopStars() {
  if (!currentUser) return;
  const topStarsEl = document.getElementById("topStars");
  if (topStarsEl) {
    topStarsEl.textContent = currentUser.stars;
  }
  const menuStarsEl = document.getElementById("menuStars");
  if (menuStarsEl) {
    menuStarsEl.textContent = currentUser.stars;
  }
}

// —Å—Ç–∞—Ä—Ç—É–µ–º —Å —ç–∫—Ä–∞–Ω–∞ –ª–æ–≥–∏–Ω–∞
showOnly("loginScreen");
</script>
</body>
</html>
